---


    #- name: "{{ recipe_name }}: Send cmd before starting server."
    #  vars:
    #    stage: "init_start_server"
    #    wait_for_ofile: False
    #    cmd: "ignore_timer_events@false"
    #    where: "/raft_net_info/ignore_timer_events"
    #    copy_to: "init"
    #    init_server: "{{lookup('niova_ctlrequest', 'apply_cmd', Server0UUID, cmd, where, wantlist=True)}}"
    #  debug:
    #    msg: "{{ init_server }}"
    #  no_log:  True

    - name: "Start the peer"
      debug:
       msg: "{{lookup('niova_raftprocess', 'start', ServerUUID, wantlist=True)}}"
      no_log: True

    - name: "Wait for server process to bootup completely"
      debug:
        msg: "Wait till bootup completes for Peer {{ ServerUUID }}."
      vars:
        stage: "start_server"
      until: (lookup('niova_ctlrequest', 'lookup', ServerUUID, '/raft_root_entry', wantlist=True)| dict2items | map(attribute='value') | list | first != "null") and (lookup('niova_ctlrequest', 'lookup', ServerUUID, '/raft_root_entry/0/state', wantlist=True)| dict2items | map(attribute='value') | list | first != "booting")
      retries: 5
      delay: 1
